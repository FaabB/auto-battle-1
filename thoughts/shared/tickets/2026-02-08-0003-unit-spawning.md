# Ticket 3: Unit Spawning — DONE

**Status:** Completed 2026-02-14

**Delivers:** Buildings produce units over time, rendered as colored circles

**Depends on:** 2

## What to Implement

| What to implement | How to test |
|-------------------|-------------|
| Unit component (UnitType, Team marker) | Components defined |
| Health component (current, max) | Health struct usable on units |
| Combat stats component (damage, attack_speed, range) | Stats struct defined |
| Movement component (speed) | Movement speed configurable per unit |
| Production timer on Barracks buildings | Timer ticks down each frame |
| Spawn unit at building position when timer fires | Place Barracks → after ~3 seconds a unit appears nearby |
| Unit rendering as circles | Player units = green circles |
| Team coloring (Player team) | Units are clearly player-colored |
| Units spawn and idle (no movement yet) | Units accumulate near their barracks |

## Context

This is the first ticket where the game "comes alive" — buildings actually do something. Only Barracks produce units; Farms don't produce units (they'll generate gold in Ticket 6).

Unit stats for the prototype soldier:
- Health: 100
- Damage: 10
- Attack speed: 1.0/sec
- Movement speed: ~50 units/sec
- Attack range: ~30 units

These values will be tuned later. The important thing is that units spawn, are visible, and have the right components for Ticket 4 (movement) and Ticket 5 (combat).

Units should spawn slightly to the right of their parent building (toward the combat zone) to avoid visual overlap with the building grid.

Relevant files:
- New domain module `src/gameplay/units/mod.rs` — Unit, Health, CombatStats, Movement, Team components (co-located with systems)
- `src/gameplay/building/mod.rs` — add production timer to Barracks, spawn system in `gameplay/building/` or `gameplay/units/`
- Systems register in their own domain plugin using `.in_set(GameSet::Production)`
- New plugin registered in `src/gameplay/mod.rs` compositor

## Done When

- Place a Barracks building
- Wait ~3 seconds
- See a green circle spawn near the building
- More units continue spawning at regular intervals
- Units stay near their spawn point (no movement yet)

## Architecture Notes

- **Two orthogonal states** — `GameState` in `screens/mod.rs`, `Menu` in `menus/mod.rs`. Gameplay systems use `.run_if(in_state(GameState::InGame).and(in_state(Menu::None)))`. No `InGameState` SubState.
- **Component co-location** — `Team` enum and unit components live in `src/gameplay/units/mod.rs`. No shared `components/` module. See `ARCHITECTURE.md`.
- **Function plugin pattern** — new `units` module uses `pub(super) fn plugin(app: &mut App)`, registered in `src/gameplay/mod.rs` compositor.
- **Production systems** use `.in_set(GameSet::Production)` for correct frame ordering.

## References

- Source: `thoughts/shared/research/2026-02-04-tano-style-game-research.md` (Section 2.3 Unit System, Section 2.2 Building System production)
